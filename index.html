<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tegy S - –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ë–æ—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> <!-- –î–ª—è AI-–∑–∞–ø—Ä–æ—Å–æ–≤ -->
    <link rel="manifest" href="/manifest.json"> <!-- –î–ª—è PWA; —Å–æ–∑–¥–∞–π—Ç–µ manifest.json —Å: {"name": "Tegy S", "short_name": "TegyS", "start_url": "/", "display": "standalone", "background_color": "#6a11cb", "theme_color": "#2575fc", "icons": [{"src": "icon.png", "sizes": "192x192", "type": "image/png"}]} -->
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-y: auto;
            animation: fadeIn 1s ease-in-out;
            transition: background 0.5s;
            position: relative; /* –î–ª—è parallax */
        }
        body.dark {
            background: linear-gradient(135deg, #1e1e1e 0%, #333 100%);
            color: #ddd;
        }
        .parallax-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0) 70%);
            pointer-events: none;
            animation: parallax 10s linear infinite;
        }
        @keyframes parallax {
            0% { background-position: 0 0; } 100% { background-position: 100px 100px; }
        }
        @keyframes fadeIn {
            from { opacity: 0; } to { opacity: 1; }
        }
        h1 {
            font-size: 2.5em;
            margin: 20px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; }
        }
        .section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            animation: cardAppear 0.8s ease-in-out;
        }
        body.dark .section {
            background: rgba(0, 0, 0, 0.3);
        }
        @keyframes cardAppear {
            from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; }
        }
        .button {
            background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%);
            border: none;
            border-radius: 10px;
            color: #fff;
            padding: 15px 30px;
            font-size: 1.2em;
            margin: 10px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); }
        }
        .button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }
        .flashcard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 10px;
        }
        .flashcard {
            background: #fff;
            color: #333;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.5s;
            cursor: pointer;
        }
        .flashcard.flipped {
            transform: rotateY(180deg);
        }
        body.dark .flashcard {
            background: #444;
            color: #fff;
        }
        .flashcard img {
            max-width: 100%;
            border-radius: 10px;
            margin-bottom: 10px;
            loading: lazy;
        }
        .quiz-input {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            border: none;
            width: 80%;
        }
        .result {
            font-size: 1.2em;
            margin-top: 10px;
        }
        .about-text {
            font-size: 1em;
            line-height: 1.5;
        }
        .level-section {
            display: none;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f00;
            animation: confetti-fall 1s linear;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        .progress-bar {
            background: #ddd;
            height: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .progress-fill {
            background: #4caf50;
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s;
        }
        .award {
            font-size: 2em;
            animation: bounce 1s;
        }
        @keyframes bounce {
            0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); }
        }
        .search-input {
            padding: 10px;
            width: 80%;
            margin-bottom: 10px;
            border-radius: 5px;
            border: none;
        }
        iframe {
            width: 100%;
            height: 200px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .drag-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        .drag-item {
            padding: 10px;
            background: #eee;
            border-radius: 5px;
            cursor: grab;
        }
        body.dark .drag-item {
            background: #555;
        }
        .drop-zone {
            padding: 10px;
            border: 2px dashed #ccc;
            min-height: 50px;
            margin: 10px;
        }
        .streak {
            font-size: 1em;
            color: gold;
            margin: 10px;
        }
    </style>
</head>
<body>
    <div class="parallax-bg"></div> <!-- Parallax-—Ñ–æ–Ω -->
    <h1>Tegy S: –û–±—É—á–µ–Ω–∏–µ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º</h1>
    
    <div id="main-menu" class="section">
        <p id="menu-text">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:</p>
        <select id="language-switch" onchange="switchLanguage(this.value)">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
        </select>
        <button class="button" onclick="showSection('english')"><i class="fas fa-book"></i> <span id="english-btn">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫</span></button>
        <button class="button" onclick="showSection('about')"><i class="fas fa-info-circle"></i> <span id="about-btn">–û –Ω–∞—Å</span></button>
        <button class="button" onclick="toggleTheme()"><i class="fas fa-moon"></i> <span id="theme-btn">–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</span></button>
        <p class="streak" id="streak-display">–°—Ç—Ä–∏–∫: 0 –¥–Ω–µ–π üî•</p>
    </div>
    
    <div id="english-section" class="section" style="display: none;">
        <h2 id="english-title">–£—Ä–æ–∫–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞</h2>
        <input type="text" class="search-input" id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤–∞–º..." oninput="searchFlashcards()">
        <p id="level-select-text">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å:</p>
        <button class="button" onclick="showLevel('beginner')"><i class="fas fa-star"></i> <span id="beginner-btn">Beginner (–ù–∞—á–∏–Ω–∞—é—â–∏–π)</span></button>
        <button class="button" onclick="showLevel('intermediate')"><i class="fas fa-star-half-alt"></i> <span id="intermediate-btn">Intermediate (–°—Ä–µ–¥–Ω–∏–π)</span></button>
        <button class="button" onclick="showLevel('advanced')"><i class="fas fa-star"></i> <span id="advanced-btn">Advanced (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π)</span></button>
        <button class="button" onclick="generateDailyChallenge()"><i class="fas fa-bolt"></i> <span id="challenge-btn">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—ã–∑–æ–≤</span></button>
        <button class="button" onclick="exportProgress()"><i class="fas fa-download"></i> <span id="export-btn">–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span></button>
        
        <!-- –£—Ä–æ–≤–Ω–∏ (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ) -->
        <div id="beginner-level" class="level-section">
            <h3 id="beginner-title">Beginner: –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ —Ñ—Ä–∞–∑—ã</h3>
            <div class="progress-bar"><div class="progress-fill" id="progress-beginner" style="width: 0%;"></div></div>
            <div class="flashcard-grid" id="flashcards-beginner"></div>
            <div id="quizzes-beginner"></div>
            <div class="drag-container" id="drag-beginner">
                <h4 id="drag-title">–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞ (Drag-and-Drop)</h4>
                <div class="drag-items"></div>
                <div class="drop-zones"></div>
            </div>
            <button class="button" id="ai-beginner" onclick="askAI('beginner')"><i class="fas fa-robot"></i> <span id="ai-btn">–°–ø—Ä–æ—Å–∏ AI –æ–± –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏</span></button>
            <div id="award-beginner" style="display: none;"><span class="award">üèÜ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</span></div>
            <button class="button" onclick="repeatLevel('beginner')"><span id="repeat-btn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</span></button>
            <button class="button" style="display: none;" id="next-beginner" onclick="showLevel('intermediate')"><span id="next-btn">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å: Intermediate</span></button>
            <button class="button" onclick="hideLevels()"><span id="back-btn">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —É—Ä–æ–≤–Ω—è–º</span></button>
        </div>
        
        <div id="intermediate-level" class="level-section">
            <h3 id="intermediate-title">Intermediate: –§—Ä–∞–∑—ã –∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞</h3>
            <div class="progress-bar"><div class="progress-fill" id="progress-intermediate" style="width: 0%;"></div></div>
            <div class="flashcard-grid" id="flashcards-intermediate"></div>
            <div id="quizzes-intermediate"></div>
            <div class="drag-container" id="drag-intermediate">
                <h4 id="drag-title">–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Ñ—Ä–∞–∑—ã</h4>
                <div class="drag-items"></div>
                <div class="drop-zones"></div>
            </div>
            <button class="button" id="ai-intermediate" onclick="askAI('intermediate')"><i class="fas fa-robot"></i> <span id="ai-btn">–°–ø—Ä–æ—Å–∏ AI</span></button>
            <div id="award-intermediate" style="display: none;"><span class="award">üèÜ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</span></div>
            <button class="button" onclick="repeatLevel('intermediate')"><span id="repeat-btn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</span></button>
            <button class="button" style="display: none;" id="next-intermediate" onclick="showLevel('advanced')"><span id="next-btn">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å: Advanced</span></button>
            <button class="button" onclick="hideLevels()"><span id="back-btn">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —É—Ä–æ–≤–Ω—è–º</span></button>
        </div>
        
        <div id="advanced-level" class="level-section">
            <h3 id="advanced-title">Advanced: –ò–¥–∏–æ–º—ã –∏ —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</h3>
            <div class="progress-bar"><div class="progress-fill" id="progress-advanced" style="width: 0%;"></div></div>
            <div class="flashcard-grid" id="flashcards-advanced"></div>
            <div id="quizzes-advanced"></div>
            <div class="drag-container" id="drag-advanced">
                <h4 id="drag-title">–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –∏–¥–∏–æ–º—ã</h4>
                <div class="drag-items"></div>
                <div class="drop-zones"></div>
            </div>
            <button class="button" id="ai-advanced" onclick="askAI('advanced')"><i class="fas fa-robot"></i> <span id="ai-btn">–°–ø—Ä–æ—Å–∏ AI</span></button>
            <div id="award-advanced" style="display: none;"><span class="award">üèÜ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</span></div>
            <button class="button" onclick="repeatLevel('advanced')"><span id="repeat-btn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</span></button>
            <button class="button" style="display: none;" id="next-advanced" onclick="showMainMenu()"><span id="finish-btn">–ó–∞–≤–µ—Ä—à–∏—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é)</span></button>
            <button class="button" onclick="hideLevels()"><span id="back-btn">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —É—Ä–æ–≤–Ω—è–º</span></button>
        </div>
    </div>
    
    <div id="about-section" class="section" style="display: none;">
        <h2 id="about-title">–û –Ω–∞—Å</h2>
        <p class="about-text" id="about-text">Tegcompany ‚Äî –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –≤ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ë–µ–ª–∞—Ä—É—Å—å –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–º –Æ—Ä–∫–µ–≤–∏—á–µ–º –ê—Ä—Ç—ë–º–æ–º –ò–≥–æ—Ä–µ–≤–∏—á–µ–º. –° –º–æ–º–µ–Ω—Ç–∞ —Å–≤–æ–µ–≥–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—è Tegcompany —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏–ª–∞—Å—å –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –Ω–∞—á–∞–≤ —Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–≤—ã—Ö —á–∞—Ç-–±–æ—Ç–æ–≤ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ ‚Äî Tegych P –∏ Beeprav P. –≠—Ç–∏ –ø—Ä–æ–µ–∫—Ç—ã —Å—Ç–∞–ª–∏ –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –≤ —Ä–∞–∑–≤–∏—Ç–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏, –∑–∞–ª–æ–∂–∏–≤ –æ—Å–Ω–æ–≤—É –¥–ª—è –±—É–¥—É—â–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤.</p>
        <button class="button" onclick="showMainMenu()"><span id="back-btn">–ù–∞–∑–∞–¥</span></button>
    </div>
    
    <script>
        // –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º (–º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å)
        class TegyApp {
            constructor() {
                this.language = localStorage.getItem('tegyLang') || 'ru';
                this.progress = JSON.parse(localStorage.getItem('tegyProgress')) || { beginner: 0, intermediate: 0, advanced: 0 };
                this.streak = parseInt(localStorage.getItem('tegyStreak')) || 0;
                this.lastVisit = localStorage.getItem('tegyLastVisit') || new Date().toDateString();
                this.init();
            }

            init() {
                // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
                const initData = Telegram.WebApp.initDataUnsafe;
                if (!initData || !initData.user) {
                    document.body.innerHTML = '<p style="color: white; text-align: center;">–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram!</p>';
                    return;
                }
                Telegram.WebApp.ready();
                Telegram.WebApp.MainButton.text = this.getText('back-menu');
                Telegram.WebApp.MainButton.onClick(() => this.showMainMenu());
                Telegram.WebApp.MainButton.show();

                // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã
                if (localStorage.getItem('tegyTheme') === 'dark') document.body.classList.add('dark');

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–∏–∫–æ–≤
                const today = new Date().toDateString();
                if (this.lastVisit !== today) {
                    this.streak = this.lastVisit === new Date(Date.now() - 86400000).toDateString() ? this.streak + 1 : 1;
                    localStorage.setItem('tegyStreak', this.streak);
                    localStorage.setItem('tegyLastVisit', today);
                }
                document.getElementById('streak-display').innerText = `${this.getText('streak')}: ${this.streak} –¥–Ω–µ–π üî•`;

                // Switch —è–∑—ã–∫–∞
                document.getElementById('language-switch').value = this.language;
                this.switchLanguage(this.language);

                // PWA Service Worker
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.register('/sw.js')  // –°–æ–∑–¥–∞–π—Ç–µ sw.js —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤
                        .then(() => console.log('PWA ready!'))
                        .catch(e => console.error('PWA error:', e));
                }

                // –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é
                this.showMainMenu();
            }

            getText(key) {
                const texts = {
                    ru: {
                        'back-menu': '–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é',
                        'english-btn': '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫',
                        'about-btn': '–û –Ω–∞—Å',
                        'theme-btn': '–¢—ë–º–Ω–∞—è —Ç–µ–º–∞',
                        'streak': '–°—Ç—Ä–∏–∫',
                        'english-title': '–£—Ä–æ–∫–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞',
                        'level-select-text': '–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å',
                        'beginner-btn': 'Beginner (–ù–∞—á–∏–Ω–∞—é—â–∏–π)',
                        'intermediate-btn': 'Intermediate (–°—Ä–µ–¥–Ω–∏–π)',
                        'advanced-btn': 'Advanced (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π)',
                        'challenge-btn': '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—ã–∑–æ–≤',
                        'export-btn': '–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞',
                        'beginner-title': 'Beginner: –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ —Ñ—Ä–∞–∑—ã',
                        'intermediate-title': 'Intermediate: –§—Ä–∞–∑—ã –∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞',
                        'advanced-title': 'Advanced: –ò–¥–∏–æ–º—ã –∏ —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏',
                        'drag-title': '–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞ (Drag-and-Drop)',
                        'ai-btn': '–°–ø—Ä–æ—Å–∏ AI –æ–± –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏',
                        'repeat-btn': '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å',
                        'next-btn': '–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å',
                        'finish-btn': '–ó–∞–≤–µ—Ä—à–∏—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é)',
                        'back-btn': '–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —É—Ä–æ–≤–Ω—è–º',
                        'about-title': '–û –Ω–∞—Å',
                        'about-text': 'Tegcompany ‚Äî –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –≤ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ë–µ–ª–∞—Ä—É—Å—å –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–º –Æ—Ä–∫–µ–≤–∏—á–µ–º –ê—Ä—Ç—ë–º–æ–º –ò–≥–æ—Ä–µ–≤–∏—á–µ–º. –° –º–æ–º–µ–Ω—Ç–∞ —Å–≤–æ–µ–≥–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—è Tegcompany —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏–ª–∞—Å—å –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –Ω–∞—á–∞–≤ —Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–≤—ã—Ö —á–∞—Ç-–±–æ—Ç–æ–≤ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ ‚Äî Tegych P –∏ Beeprav P. –≠—Ç–∏ –ø—Ä–æ–µ–∫—Ç—ã —Å—Ç–∞–ª–∏ –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –≤ —Ä–∞–∑–≤–∏—Ç–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏, –∑–∞–ª–æ–∂–∏–≤ –æ—Å–Ω–æ–≤—É –¥–ª—è –±—É–¥—É—â–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤.'
                    },
                    en: {
                        'back-menu': 'Back to Menu',
                        'english-btn': 'English Language',
                        'about-btn': 'About Us',
                        'theme-btn': 'Dark Theme',
                        'streak': 'Streak',
                        'english-title': 'English Lessons',
                        'level-select-text': 'Choose Level',
                        'beginner-btn': 'Beginner',
                        'intermediate-btn': 'Intermediate',
                        'advanced-btn': 'Advanced',
                        'challenge-btn': 'Daily Challenge',
                        'export-btn': 'Export Progress',
                        'beginner-title': 'Beginner: Basic Words and Phrases',
                        'intermediate-title': 'Intermediate: Phrases and Grammar',
                        'advanced-title': 'Advanced: Idioms and Complex Structures',
                        'drag-title': 'Match Words (Drag-and-Drop)',
                        'ai-btn': 'Ask AI for Explanation',
                        'repeat-btn': 'Repeat Level',
                        'next-btn': 'Next Level',
                        'finish-btn': 'Finish English (Back to Menu)',
                        'back-btn': 'Back to Levels',
                        'about-title': 'About Us',
                        'about-text': 'Tegcompany is an innovative company founded in the Republic of Belarus by entrepreneur Yurkevich Artem Igorevich. From its inception, Tegcompany has focused on developing intelligent solutions, starting with the creation of the first chatbots with artificial intelligence elements ‚Äî Tegych P and Beeprav P. These projects became the starting point in the company's development, laying the foundation for future technological initiatives.'
                    }
                };
                return texts[this.language][key] || key;
            }

            switchLanguage(lang) {
                this.language = lang;
                localStorage.setItem('tegyLang', lang);
                // –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç
                document.getElementById('menu-text').innerText = this.getText('level-select-text');
                document.getElementById('english-btn').innerText = this.getText('english-btn');
                document.getElementById('about-btn').innerText = this.getText('about-btn');
                document.getElementById('theme-btn').innerText = this.getText('theme-btn');
                document.getElementById('english-title').innerText = this.getText('english-title');
                document.getElementById('level-select-text').innerText = this.getText('level-select-text');
                document.getElementById('beginner-btn').innerText = this.getText('beginner-btn');
                document.getElementById('intermediate-btn').innerText = this.getText('intermediate-btn');
                document.getElementById('advanced-btn').innerText = this.getText('advanced-btn');
                document.getElementById('challenge-btn').innerText = this.getText('challenge-btn');
                document.getElementById('export-btn').innerText = this.getText('export-btn');
                document.getElementById('beginner-title').innerText = this.getText('beginner-title');
                document.getElementById('intermediate-title').innerText = this.getText('intermediate-title');
                document.getElementById('advanced-title').innerText = this.getText('advanced-title');
                document.getElementById('drag-title').innerText = this.getText('drag-title');
                document.getElementById('ai-btn').innerText = this.getText('ai-btn');
                document.getElementById('repeat-btn').innerText = this.getText('repeat-btn');
                document.getElementById('next-btn').innerText = this.getText('next-btn');
                document.getElementById('finish-btn').innerText = this.getText('finish-btn');
                document.getElementById('back-btn').innerText = this.getText('back-btn');
                document.getElementById('about-title').innerText = this.getText('about-title');
                document.getElementById('about-text').innerText = this.getText('about-text');
                // –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –æ—Ç–∫—Ä—ã—Ç
                const openLevel = document.querySelector('.level-section[style*="block"]');
                if (openLevel) this.showLevel(openLevel.id.split('-')[0]);
            }

            // ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: generateFlashcards, generateQuizzes, showLevel, etc. –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏)

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–∏–∑–∞ (–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
            checkQuiz(quizId, correctAnswer, level) {
                try {
                    const answer = document.getElementById(`quiz-${quizId}`).value.trim().toLowerCase();
                    const result = document.getElementById(`result-${quizId}`);
                    if (answer === correctAnswer) {
                        result.innerText = this.getText('correct') || '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üéâ';
                        result.style.color = 'green';
                        Telegram.WebApp.sendData(JSON.stringify({ quiz: 'english', level: level, status: 'correct' }));
                        this.progress[level]++;
                        localStorage.setItem('tegyProgress', JSON.stringify(this.progress));
                        this.updateProgress(level);
                        // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ (–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π —Ü–∏–∫–ª)
                        for (let i = 0; i < 20; i++) {
                            const confetti = document.createElement('div');
                            confetti.className = 'confetti';
                            confetti.style.left = `${Math.random() * 100}vw`;
                            confetti.style.top = `${Math.random() * 100}vh`;
                            confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                            confetti.style.animationDuration = `${Math.random() * 2 + 1}s`;
                            document.body.appendChild(confetti);
                            setTimeout(() => confetti.remove(), 3000); // –£–≤–µ–ª–∏—á–∏–ª –≤—Ä–µ–º—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞
                        }
                    } else {
                        result.innerText = this.getText('incorrect') || '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞!';
                        result.style.color = 'red';
                        Telegram.WebApp.sendData(JSON.stringify({ quiz: 'english', level: level, status: 'incorrect' }));
                    }
                    // –û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
                    const button = result.previousElementSibling;
                    button.disabled = true;
                    button.innerText = this.getText('checked') || '–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ';
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –≤ –∫–≤–∏–∑–µ:', e);
                    const result = document.getElementById(`result-${quizId}`);
                    result.innerText = this.getText('error') || '–û—à–∏–±–∫–∞! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
                    result.style.color = 'orange';
                }
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è AI (ChatGPT)
            askAI(level) {
                const prompt = prompt(this.getText('ai-prompt') || '–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è:');
                if (!prompt) return;
                axios.post('https://api.openai.com/v1/chat/completions', {
                    model: 'gpt-3.5-turbo',
                    messages: [{ role: 'user', content: `Explain in simple terms for ${level} level: ${prompt}` }]
                }, {
                    headers: { 'Authorization': 'Bearer YOUR_OPENAI_API_KEY' }  // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –∫–ª—é—á
                }).then(response => {
                    alert(response.data.choices[0].message.content);
                }).catch(e => {
                    console.error('AI error:', e);
                    alert(this.getText('ai-error') || '–û—à–∏–±–∫–∞ AI. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –∏–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.');
                });
            }

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (—Å–ª—É—á–∞–π–Ω—ã–π –∫–≤–∏–∑)
            generateDailyChallenge() {
                const levels = ['beginner', 'intermediate', 'advanced'];
                const randomLevel = levels[Math.floor(Math.random() * levels.length)];
                const randomQuiz = lessons[randomLevel].quizzes[Math.floor(Math.random() * lessons[randomLevel].quizzes.length)];
                const challengeDiv = document.createElement('div');
                challengeDiv.innerHTML = `<p>${this.getText('daily-challenge') || '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—ã–∑–æ–≤'}: ${randomQuiz.question} (–£—Ä–æ–≤–µ–Ω—å: ${randomLevel.capitalize()})</p>
                    <input type="text" id="challenge-input" class="quiz-input" placeholder="${this.getText('answer-placeholder') || '–í–∞—à –æ—Ç–≤–µ—Ç'}">
                    <button class="button" onclick="app.checkQuiz('challenge', '${randomQuiz.answer}', '${randomLevel}')">${this.getText('check') || '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å'}</button>
                    <p id="result-challenge" class="result"></p>`;
                document.getElementById('english-section').appendChild(challengeDiv);
            }

            // –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            exportProgress() {
                const data = JSON.stringify(this.progress);
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'tegy_progress.json';
                a.click();
                URL.revokeObjectURL(url);
            }

            // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
            shareProgress(level) {
                const prog = this.progress[level];
                Telegram.WebApp.showPopup({
                    title: this.getText('share') || '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è',
                    message: `${this.getText('progress-share') || '–ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ —É—Ä–æ–≤–Ω–µ'} ${level}: ${prog} –±–∞–ª–ª–æ–≤!`,
                    buttons: [{ type: 'ok', text: 'OK' }]
                });
            }

            // Drag-and-Drop (–ø—Ä–∏–º–µ—Ä –¥–ª—è matching)
            setupDragAndDrop(level) {
                const container = document.getElementById(`drag-${level}`);
                container.innerHTML = `<h4>${this.getText('drag-title')}</h4><div class="drag-items"></div><div class="drop-zones"></div>`;
                const words = lessons[level].flashcards.slice(0, 4).map(f => f.word);
                const translations = lessons[level].flashcards.slice(0, 4).map(f => f.translation).sort(() => 0.5 - Math.random());
                words.forEach(w => {
                    const item = document.createElement('div');
                    item.className = 'drag-item';
                    item.draggable = true;
                    item.innerText = w;
                    item.ondragstart = e => e.dataTransfer.setData('text', w);
                    document.querySelector(`#drag-${level} .drag-items`).appendChild(item);
                });
                translations.forEach(t => {
                    const zone = document.createElement('div');
                    zone.className = 'drop-zone';
                    zone.innerText = t;
                    zone.ondrop = e => {
                        e.preventDefault();
                        const data = e.dataTransfer.getData('text');
                        if (lessons[level].flashcards.find(f => f.word === data && f.translation === t)) {
                            zone.style.background = 'green';
                            update_progress(this, level, 1); // –ë–∞–ª–ª –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π match
                        } else {
                            zone.style.background = 'red';
                        }
                    };
                    zone.ondragover = e => e.preventDefault();
                    document.querySelector(`#drag-${level} .drop-zones`).appendChild(zone);
                });
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ç—Ä–∏–∫–æ–≤ –∏ —Ç.–¥.)
            // (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏, —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º this.setupDragAndDrop(level) –≤ showLevel)
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const app = new TegyApp();
    </script>
</body>
</html>
